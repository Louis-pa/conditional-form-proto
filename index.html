<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Enhanced Form Design</title>
  <!-- Include Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Include Font Awesome for icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    .form-container {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f8f9fa;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    .form-label {
      display: flex;
      align-items: center;
    }
    .form-label i {
      margin-right: 8px;
    }
    .form-buttons {
      display: flex;
      justify-content: space-between;
    }
  </style>
</head>
<body>
  <div class="container mt-5">
    <div class="form-container">
      <h3 class="mb-4 text-center">Add a Trigger</h3>
      <form id="triggerForm">
        <!-- Source Section -->
        <div class="form-group mb-3">
          <label for="source" class="form-label required"><i class="fas fa-database"></i> Source</label>
          <select id="source" class="form-control">
            <option value="" disabled selected>Select a source</option>
            <option value="budgets">Budgets</option>
            <option value="savings">Savings</option>
            <option value="opportunity">Opportunity</option>
            <option value="contract">Contract</option>
            <option value="supplier">Supplier</option>
          </select>
        </div>

        <!-- Field Selection -->
        <div class="form-group mb-3" id="fieldSection" style="display: none;">
          <label for="attributeName" class="form-label required"><i class="fas fa-list"></i> Field</label>
          <select id="attributeName" class="form-control">
            <option value="" disabled selected>Select a field</option>
            <option value="axis">Analytical axis</option>
            <option value="status">Category - Non functional for POC</option>
            <option value="axis">Stakeholder - Non functional for POC</option>
            <option value="status">Business Units - Non functional for POC</option>
            <option value="status">Action type - Non functional for POC</option>
          </select>
        </div>

        <!-- Condition Section -->
        <div class="form-group mb-3" id="conditionSection" style="display: none;">
          <label for="conditionOperator" class="form-label required"><i class="fas fa-filter"></i> Condition</label>
          <select id="conditionOperator" class="form-control">
            <option value="" disabled selected>Select a condition</option>
            <option value="is">Is</option>
            <option value="is_not">Is not</option>
          </select>
        </div>

        <!-- Values Section -->
        <div class="form-group mb-3" id="valuesSection" style="display: none;">
          <label for="valueMultiple" class="form-label"><i class="fas fa-tags"></i> Values</label>
          <select id="valueMultiple" class="form-control">
            <option value="" disabled selected>Select a value</option>
            <option value="template1">Template 1</option>
            <option value="template2">Template 2</option>
            <option value="template3">Template 3</option>
          </select>
        </div>

        <!-- Then Section -->
        <div class="form-group mb-3" id="thenSection" style="display: none;">
          <label for="thenSelector" class="form-label"><i class="fas fa-arrow-right"></i> Then</label>
          <select id="thenSelector" class="form-control">
            <option value="" disabled selected>Select an option</option>
            <option value="country">Country</option>
            <option value="business_units">Business Units</option>
            <option value="currency">Currency</option>
            <option value="stakeholders">Stakeholders</option>
          </select>
        </div>

        <!-- IS Section -->
        <div class="form-group mb-3" id="isSection" style="display: none;">
          <label for="isSelector" class="form-label"><i class="fas fa-check"></i> IS</label>
          <select id="isSelector" class="form-control">
            <option value="" disabled selected>Select an option</option>
          </select>
        </div>

        <!-- Form Buttons -->
        <div class="form-buttons mt-4">
          <button class="btn btn-light" type="reset">Cancel</button>
          <button class="btn btn-primary" type="submit">Save</button>
        </div>

        <!-- Add Button -->
        <div class="mt-3 text-center">
          <button id="addCondition" class="btn btn-secondary">Add Condition</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Include Bootstrap JS and dependencies -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Include Font Awesome JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>

  <!-- JavaScript to handle dynamic behavior -->
  <script>
    document.getElementById('source').addEventListener('change', function() {
      document.getElementById('fieldSection').style.display = this.value ? 'block' : 'none';
    });

    document.getElementById('attributeName').addEventListener('change', function() {
      document.getElementById('conditionSection').style.display = this.value ? 'block' : 'none';
    });

    document.getElementById('conditionOperator').addEventListener('change', function() {
      document.getElementById('valuesSection').style.display = this.value ? 'block' : 'none';
    });

    document.getElementById('valueMultiple').addEventListener('change', function() {
      document.getElementById('thenSection').style.display = this.value ? 'block' : 'none';
    });

    document.getElementById('thenSelector').addEventListener('change', function() {
      var selectedThen = this.value;
      var isSelector = document.getElementById('isSelector');
      isSelector.innerHTML = ''; // Clear previous options

      var options = [];
      if (selectedThen === 'country') {
        options = [
          { value: 'france', text: 'France' },
          { value: 'uk', text: 'UK' },
          { value: 'germany', text: 'Germany' }
        ];
      } else if (selectedThen === 'business_units') {
        options = [
          { value: 'bu_a', text: 'BU A' },
          { value: 'bu_b', text: 'BU B' },
          { value: 'bu_c', text: 'BU C' }
        ];
      } else if (selectedThen === 'currency') {
        options = [
          { value: 'eur', text: 'EUR' },
          { value: 'usd', text: 'USD' },
          { value: 'gbp', text: 'GBP' }
        ];
      } else if (selectedThen === 'stakeholders') {
        options = [
          { value: 'marketing', text: 'Marketing' },
          { value: 'finance', text: 'Finance' },
          { value: 'random', text: 'Random' }
        ];
      }

      options.forEach(function(option) {
        var opt = document.createElement('option');
        opt.value = option.value;
        opt.text = option.text;
        isSelector.add(opt);
      });

      document.getElementById('isSection').style.display = selectedThen ? 'block' : 'none';
    });

    document.getElementById('addCondition').addEventListener('click', function(e) {
      e.preventDefault(); // Prevent form submission

      var newConditionSection = document.createElement('div');
      newConditionSection.innerHTML = `
        <div class="form-group mb-3">
          <label for="thenSelector" class="form-label"><i class="fas fa-plus"></i> And</label>
          <select class="form-control thenSelector">
            <option value="" disabled selected>Select an option</option>
            <option value="country">Country</option>
            <option value="business_units">Business Units</option>
            <option value="currency">Currency</option>
            <option value="stakeholders">Stakeholders</option>
          </select>
        </div>
        <div class="form-group mb-3 isSection" style="display: none;">
          <label for="isSelector" class="form-label"><i class="fas fa-check"></i> IS</label>
          <select class="form-control isSelector">
            <option value="" disabled selected>Select an option</option>
          </select>
        </div>
      `;

      var formButtons = document.querySelector('.form-buttons');
      document.getElementById('triggerForm').insertBefore(newConditionSection, formButtons);

      newConditionSection.querySelector('.thenSelector').addEventListener('change', function() {
        var selectedThen = this.value;
        var newIsSelector = newConditionSection.querySelector('.isSelector');
        newIsSelector.innerHTML = ''; // Clear previous options

        var options = [];
        if (selectedThen === 'country') {
          options = [
            { value: 'france', text: 'France' },
            { value: 'uk', text: 'UK' },
            { value: 'germany', text: 'Germany' }
          ];
        } else if (selectedThen === 'business_units') {
          options = [
            { value: 'bu_a', text: 'BU A' },
            { value: 'bu_b', text: 'BU B' },
            { value: 'bu_c', text: 'BU C' }
          ];
        } else if (selectedThen === 'currency') {
          options = [
            { value: 'eur', text: 'EUR' },
            { value: 'usd', text: 'USD' },
            { value: 'gbp', text: 'GBP' }
          ];
        } else if (selectedThen === 'stakeholders') {
          options = [
            { value: 'marketing', text: 'Marketing' },
            { value: 'finance', text: 'Finance' },
            { value: 'random', text: 'Random' }
          ];
        }

        options.forEach(function(option) {
          var opt = document.createElement('option');
          opt.value = option.value;
          opt.text = option.text;
          newIsSelector.add(opt);
        });

        newConditionSection.querySelector('.isSection').style.display = 'block';
      });
    });
  </script>
</body>
</html>